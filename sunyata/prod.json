{
    "profile": "tenzing-dev",
    "regions": "us-east-1",
    "name": "tenzing",
    "description": "tenzing stack.",
    "stages": ["prod"],
    "config_path": "sunyata.json",
    "stage_config": {
        "debug_enabled":true,
        "auth_enabled":false
    },
    "extra_cloudformation_templates": ["cf_templates/repo_bucket.cf.json"],
    "lambdas": [
        {
            "name":"dispatcher",
            "runtime":"python3.6",
            "handler":"handlers.dispatcher",
            "directory":"tenzing-zipdir",
            "description":"Dispatcher for requests.",
            "timeout":10,
            "memory":256,
            "role":"base",
            "proxy":true
        }
    ],
    "paths": [
        {
            "path":"/",
            "function":"dispatcher",
            "http_method": "GET"
        },
        {
            "path":"/",
            "function":"dispatcher",
            "http_method": "POST"
        },
        {
            "path":"/{proxy+}",
            "function":"dispatcher",
            "http_method": "GET"
        },
        {
            "path":"/{proxy+}",
            "function":"dispatcher",
            "http_method": "POST"
        }
    ],
    "roles": {
        "base":[
            {
                "Effect": "Allow",
                "Action": "logs:CreateLogGroup",
                "Resource": { "Fn::Join" : [ ":", [ "arn:aws:logs",{"Ref" : "AWS::Region"},{ "Ref" : "AWS::AccountId" },"*" ] ] }
            },
            {
                "Effect": "Allow",
                "Action": [
                    "logs:CreateLogStream",
                    "logs:PutLogEvents"
                ],
                "Resource": { "Fn::Join" : [ ":", [ "arn:aws:logs",{"Ref" : "AWS::Region"},{ "Ref" : "AWS::AccountId" },"log-group:/aws/lambda/*" ] ] }
            },
            {
                "Effect": "Allow",
                "Action": "s3:*",
                "Resource": [
                    { "Fn::GetAtt" : [ "RepoBucket", "Arn" ] },
                    { "Fn::Join" : [ "/", [ { "Fn::GetAtt" : [ "RepoBucket", "Arn" ] }, "*" ] ] }
                ]
            }
        ]
    }
}
